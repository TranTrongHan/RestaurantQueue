<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="vi">
<head>
    <th:context th:replace="~{base :: resources}"></th:context>
</head>
<body>
<div th:replace="~{base :: header}"></div>

<div class="container mt-3">
    <form th:action="@{/admin/comments}" method="get">
        <div class="mb-3 mt-3">
            <input type="text" class="form-control" name="q"
                   placeholder="Từ khóa=" />
        </div>
        <div class="mb-3 mt-3">
            <input type="text" class="form-control" name="customer"
                   placeholder="Tên khách hàng="  />
        </div>
        <div class="mb-3 mt-3">
            <select class="form-select" aria-label="Default select example" name="status">
                <option>--Trạng thái--</option>
                <option th:value="PENDING" >PENDING</option>
                <option th:value="APPROVED" >APPROVED</option>
                <option th:value="REJECTED" >REJECTED</option>
            </select>
        </div>
        <div class="mb-3 mt-3">
            <button class="btn btn-info" type="submit">Lọc</button>
        </div>
    </form>
    <hr  />
    <table class="table">
        <thead>
        <tr>
            <th>Id</th>
            <th>Người gửi</th>
            <th>Nội dung</th>
            <th>Ngày gửi</th>
            <th>Trạng thái</th>
            <th>SPAM</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="c : ${comments}">
            <td th:text="${c.id}"></td>
            <td th:text="${c.customer}"></td>
            <td th:text="${c.content}"></td>
            <td th:text="${#temporals.format(c.createdAt, 'dd-MM-yyyy HH:mm')}"></td>
            <td th:text="${c.status}"></td>
            <td th:text="${c.spam}"></td>
            <td>
                <button th:if="${c.status == 'PENDING'}" class="btn btn-primary" th:onclick="'approveComment(\''+@{/api/comments/approve/}+'\','+${c.id}+')'">Duyệt</button>
                <button th:if="${c.status == 'PENDING'}" class="btn btn-danger" th:onclick="'rejectComment(\''+@{/api/comments/reject/}+'\','+${c.id}+')'">Từ chối</button>
            </td>
        </tr>
        </tbody>
    </table>
    <div class="d-flex justify-content-center">
        <nav aria-label="Page navigation example" th:if="${page.totalPages > 1}">
            <ul class="pagination">

                <!-- Previous -->
                <li class="page-item" th:classappend="${page.first} ? 'disabled'">
                    <a class="page-link"
                       th:href="@{/admin/comments(page=${page.number - 1}, size=${page.size})}"
                       aria-label="Previous">
                        <span aria-hidden="true">&laquo;</span>
                    </a>
                </li>

                <!-- Page numbers -->
                <li class="page-item"
                    th:each="i : ${#numbers.sequence(0, page.totalPages - 1)}"
                    th:classappend="${i == page.number} ? 'active'">
                    <a class="page-link"
                       th:href="@{/admin/comments(page=${i}, size=${page.size})}"
                       th:text="${i + 1}">1</a>
                </li>

                <!-- Next -->
                <li class="page-item" th:classappend="${page.last} ? 'disabled'">
                    <a class="page-link"
                       th:href="@{/admin/comments(page=${page.number + 1}, size=${page.size})}"
                       aria-label="Next">
                        <span aria-hidden="true">&raquo;</span>
                    </a>
                </li>

            </ul>
        </nav>
    </div>

</div>
<div th:replace="~{base :: footer}"></div>
<script th:src="@{/js/comment.js}"></script>
</body>
</html>